<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Video to GIF Converter</title>
    <style>
        #dropzone {
            width: 300px;
            height: 200px;
            border: 2px dashed #ccc;
            text-align: center;
            padding: 20px;
            margin: 20px auto;
        }
        #dropzone.highlight {
            border-color: purple;
        }
    </style>
</head>
<body>
    <div id="dropzone">Drag and drop video here or <label for="fileInput" style="color: blue; cursor: pointer;">click to select</label><input type="file" id="fileInput" accept="video/*" style="display: none;">
    </div>
    <a id="download" style="display:none;">Download GIF</a>
    <img id="preview" style="display:none; max-width: 100%;">
    <div id="status" style="text-align: center; margin: 10px; color: red;"></div>
    <script src="https://unpkg.com/gifshot@0.4.5/dist/gifshot.js"></script>
    <script>
        const dropzone = document.getElementById('dropzone');
        const fileInput = document.getElementById('fileInput');
        const preview = document.getElementById('preview');
        const downloadLink = document.getElementById('download');
        const status = document.getElementById('status');

        dropzone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropzone.classList.add('highlight');
        });
        dropzone.addEventListener('dragleave', () => {
            dropzone.classList.remove('highlight');
        });
        dropzone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropzone.classList.remove('highlight');
            const file = e.dataTransfer.files[0];
            if (file && file.type.startsWith('video/')) {
                processVideo(file);
            } else {
                status.textContent = 'Please drop a video file.';
                status.style.color = 'red';
            }
        });

        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file && file.type.startsWith('video/')) {
                processVideo(file);
            } else {
                status.textContent = 'Please select a video file.';
                status.style.color = 'red';
            }
        });

        function processVideo(file) {
            status.textContent = 'Processing...';
            status.style.color = 'blue';
            downloadLink.style.display = 'none';
            preview.style.display = 'none';

            const url = URL.createObjectURL(file);

            gifshot.createGIF({
                video: url,
                gifWidth: 640,
                gifHeight: 480,
                interval: 0.1, // 10 FPS
                numFrames: 100, // Limit for large videos
                frameDuration: 1,
                sampleInterval: 10
            }, function(obj) {
                if (!obj.error) {
                    preview.src = obj.image;
                    preview.style.display = 'block';
                    downloadLink.href = obj.image;
                    downloadLink.download = 'output.gif';
                    downloadLink.textContent = 'Download GIF';
                    downloadLink.style.display = 'block';
                    status.textContent = 'Conversion successful!';
                    status.style.color = 'green';
                } else {
                    status.textContent = `Error: ${obj.errorMsg}`;
                    status.style.color = 'red';
                }
                URL.revokeObjectURL(url);
            });
        }
    </script>
</body>
</html>
